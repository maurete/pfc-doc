%
%
\subsection{Núcleos}
%
Un núcleo, denominado también por su nombre en inglés \eng{kernel}, es
una función $k:X\times{}X\rightarrow{}\RR$ que generaliza el concepto
de métrica \cite{stewart}.
Dado un par de vectores $\xx_1,\xx_2\in{}X$, un núcleo permite
comparar la similaridad entre los vectores {transformados}
$\BPhi(\xx_1)$ y $\BPhi(\xx_2)$ en el espacio vectorial inducido $Z$,
sin necesidad de calcular la transformación $\BPhi$ de forma
explícita.
%
\begin{definicion}[Núcleo]
  Una función $k:X\times{}X\rightarrow{}\R{R}$ se dice un núcleo
  en el conjunto $X$ si cumple con las siguientes propiedades:
  %
  \begin{enumerate}
  \item $k(\xx_1,\xx_2)=k(\xx_2,\xx_1)$ para todo $\xx_1,\xx_2\in{}X$.
  \item Para cada $n\in\R{N}$ y para todos los puntos
    $(\xx_1,\ldots,\xx_\ell)\in{}X^\ell$, la matriz de Gram
    $K\in\R{R}^{\ell\times\ell}$ definida como
    $K_{ij}=k(\xx_i,\xx_j),\,i,j\in\{1,\ldots,\ell\}$ es semidefinida
    positiva.
  \end{enumerate}
  %
\end{definicion}
%
Para un núcleo $k$, el teorema de Mercer \cite{mercer} asegura la
existencia de un espacio imagen $Z$ y una transformación
$\BPhi:X\rightarrow{}Z$ tal que, para cualquier par de vectores
$\xx_i,\xx_j\in{}X$, el núcleo calcula el producto interno de los
mismos en el espacio imagen:
$k(\xx_i,\xx_j)=\pint{\BPhi(\xx_i)}{\BPhi(\xx_j)}$.
%% Es importante tener en cuenta que ni el espacio $F$ ni la
%% transformación $\BPhi$ son únicos.

El teorema de Mercer puede aplicarse directamente a la función
objetivo del problema dual de la SVM (\ref{e2:svm-problem-dual2}),
reemplazando los productos internos
$\pint{\BPhi(\xx_i)}{\BPhi(\xx_j)}$ por la función núcleo
$k(\xx_i,\xx_j)$.
Esta operación se denomina el ``truco del núcleo'' (del inglés
\e{kernel trick}), y da como resultado el problema
%
\begin{align}
  \begin{split}
    \max_\alpha &\quad
    -\frac{1}{2}\sum_{i=1}^\ell\sum_{j=1}^\ell y_iy_j\alpha_i\alpha_j
    k(\xx_i,\xx_j) + \sum_{i=1}^{\ell} \alpha_i \\
    \T{sujeto a} &\quad \yy^T\Balpha = 0, \\
    &\quad \alpha_i \geq 0\T{ para todo } i\in\{1,\ldots,\ell\}.
  \end{split}
  \label{e2:svm-problem-kernel}
\end{align}
%
En este problema, las operaciones de producto interno en el espacio
imagen $Z$ se efectúan a través del núcleo $k$ sin necesidad de
calcular la transformación $\BPhi$ en forma explícita.

Desde un punto de vista matemático, la utilización del truco del
núcleo no aporta ninguna ventaja frente a la aplicación de la
transformación $\BPhi$ primero y el cálculo directo de los productos
internos en $Z$ después.
Desde el punto de vista computacional, sin embargo, la diferencia es
decisiva, ya que con el truco del núcleo se pueden calcular productos
internos en espacios vectoriales de alta dimensionalidad --incluso
infinita--, para los cuales el cálculo de la transformación $\BPhi$
resulta prohibitivo o incluso imposible en una computadora
\cite{glasmachers}.
%
%% Es intuitivamente claro que la elección de un núcleo que represente
%% una métrica específica al problema puede mejorar el rendimiento de las
%% máquinas de aprendizaje. Por ejemplo, en una tarea de clasificación es
%% conveniente elegir una métrica que agrupa las diferentes clases.
